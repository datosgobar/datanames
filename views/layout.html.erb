<!DOCTYPE html>
<html>

    <head>
        <title><% if main_name %><%= main_name %><% if year %>(<%= year %>)<% end %>
        <% else %>&iquest;Qu&eacute; tan popular es tu nombre?<% end %>Nombres Argentina</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

        <meta name="description" content="Descubr&iacute; la historia y las estad&iacute;sticas de tu nombre durante los &uacute;ltimos 50 a&ntilde;os."/>
        <meta name="keywords" content="data,nombres,argentina"/>
        <meta http-equiv="Content-Language" content="en"/>

        <link href="<%= asset_path('images/favicon.png') %>" rel="shortcut icon" type="image/png"/>

        <link href="<%= stylesheet_path('webapp.css') %>" rel="stylesheet" type="text/css"/>
        <link href="<%= stylesheet_path('jqplot.css') %>" rel="stylesheet" type="text/css"/>
        <link href="<%= stylesheet_path('bootstrap.min.css') %>" rel="stylesheet" type="text/css"/>
        <link href="<%= stylesheet_path('poncho.css') %>" rel="stylesheet" type="text/css"/>
        <link href="<%= stylesheet_path('font-awesome.min.css') %>" rel="stylesheet"/>
        <script src="<%= javascript_path('modernizr.min.js') %>"></script>
        <script src="<%= javascript_path('d3.v3.min.js') %>" type="text/javascript"></script>

        <script>
          window.onload = function(){

            var dataset = ['#seccion1', '#seccion2', '#seccion3', '#seccion4'];

            var containerSlide = d3.select('#containerSlide')
              .append('svg')
              .attr('id', 'iconoSeccion')
              .selectAll('a')
              .data(dataset)
              .enter()
              .append('a')
              .attr('href', function(d){
                return d;
              })
              .append('circle')
              .attr('cx', 8)
              .attr('cy', function(d, i){
                  return 12 * (i + 1) + 27 + (12 * i);
              })
              .attr('r', 6)
              .attr('stroke', 'silver')
              .attr('fill', function(d, i){
                if (i == 0){
                  return 'silver';
                } else {
                  return 'none';
                }
              });

              var seccionPosicion1 = window.document.querySelector('#seccion1').getBoundingClientRect().top;
              var seccionPosicion2 = window.document.querySelector('#seccion2').getBoundingClientRect().top;
              var seccionPosicion3 = window.document.querySelector('#seccion3').getBoundingClientRect().top;
              var seccionPosicion4 = window.document.querySelector('#seccion4').getBoundingClientRect().top;
              var iconos = $('circle');

              $(document).scroll(function(e){
                var posicionActual = $(document).scrollTop();

                if (posicionActual > (seccionPosicion4 - 70)){
                  for (var i = 0; i < iconos.length; i++) {
                    if (iconos[i].parentNode.getAttribute('href') == '#seccion4'){
                      iconos[i].setAttribute('fill', 'silver');
                      $('#seccion' + [i + 1]).attr('class', 'panels animated')
                    } else {
                      iconos[i].setAttribute('fill', 'none');
                      $('#seccion' + [i + 1]).attr('class', 'panels')
                    }
                  }

                } else if(posicionActual > (seccionPosicion3 - 70)){
                  for (var i = 0; i < iconos.length; i++) {
                    if (iconos[i].parentNode.getAttribute('href') == '#seccion3'){
                      iconos[i].setAttribute('fill', 'silver');
                      $('#seccion' + [i + 1]).attr('class', 'panels animated')
                    } else {
                      iconos[i].setAttribute('fill', 'none');
                      $('#seccion' + [i + 1]).attr('class', 'panels')
                    }
                  }

                } else if(posicionActual > (seccionPosicion2 - 70)){
                  for (var i = 0; i < iconos.length; i++) {
                    if (iconos[i].parentNode.getAttribute('href') == '#seccion2'){
                      iconos[i].setAttribute('fill', 'silver');
                      $('#seccion' + [i + 1]).attr('class', 'panels animated')
                    } else {
                      iconos[i].setAttribute('fill', 'none');
                      $('#seccion' + [i + 1]).attr('class', 'panels')
                    }
                  }

                } else {
                  for (var i = 0; i < iconos.length; i++) {
                    if (iconos[i].parentNode.getAttribute('href') == '#seccion1'){
                      iconos[i].setAttribute('fill', 'silver');
                      $('#seccion' + [i + 1]).attr('class', 'panels animated')
                    } else {
                      iconos[i].setAttribute('fill', 'none');
                      $('#seccion' + [i + 1]).attr('class', 'panels')
                    }
                  }

                }
              });
          }
        </script>
    </head>

    <body class="<%= main_name ? 'with-name' : '' %>">

        <!-- Barra de Navegacion -->
        <header id='firstheader'>
            <div class="row hidden-print">
                <nav class="navbar navbar-top navbar-default navbar-error" role="navigation">
                    <div class="container">
                        <div class="navbar-header">
                            <div class="navbar-brand">
                                <img alt="Brand" src="/images/casarosada.svg" width="274" height="50">
                                <h1 class="sr-only">casarosada.gob.ar
                                    <small>Presidencia de la Nación</small>
                                </h1>
                            </div>
                        </div>
                        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-2">
                            <ul class="nav navbar-nav navbar-right navbar-social">
                                <li class="text-muted">
                                    Compartilo
                                    <br/>en redes
                                </li>
                                <li>
                                    <a href="javascript: window.open('https://www.facebook.com/sharer/sharer.php?u=http://www.casarosada.gob.ar/tarifasocial', 'pop', 'width=600, height=260, scrollbars=no');" target="_blank">
                                        <span class="fa fa-facebook"></span>
                                    </a>
                                </li>
                                <li>
                                    <a href="javascript: window.open('https://twitter.com/share?text=Tarifa%20Social&url=http://www.casarosada.gob.ar/tarifasocial', 'pop', 'width=600, height=260, scrollbars=no');" target="_blank">
                                        <span class="fa fa-twitter"></span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
        </header>

        <!-- Iconos Secciones -->
        <div id="containerSlide">
        </div>

        <a name='seccion1'></a>
        <section id='seccion1' class='panels animated'>

            <div id='titleIntroduction'>
                <h1 class="headerTitle">Descubrí la popularidad de tu nombre en los últimos 100 años en Argentina</h1>
                <aside class="headerSubTitle">Ingresá tu nombre y año de nacimiento</aside>
            </div>

            <div id="introduction">
                <div class="container">
                    <div class="row">
                        <div class="col-md-4 col-md-offset-4 main-form-title">
                            <form id="name-form" action="/" method="POST" autocomplete="off">
                                <div class="form-group">
                                    <label for="name">Me llamo</label>
                                    <input type="text" id="name" name="name" value="<%= names.join(', ') %>" placeholder="Maria o Juan, Carlos"/>
                                </div>
                                <div class="form-group">
                                    <label for="year">Nac&iacute; en el año</label>
                                    <input type="text" id='year' name='year' placeholder="1998" value="<%= year %>">
                                </div>
                                <button type="submit" name="submit" class="grayBtn">Ver resultados</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </section>

        <a name='seccion2'></a>
        <section id='seccion2' class='panels'>

            <section id="main">
                <%= yield %>
            </section>

        </section>

        <a name='seccion3'></a>
        <section id='seccion3' class='panels'>
            <section id="extra-name-data">
                <header class="headerSection">
                    <h2 class="headerTitle">¿Sab&iacute;as qué?</h2>
                    <aside class="headerSubTitle">Datos expresados en cantidad de personas con ese nombre.</aside>
                </header>
                <div id="nameDataContainer"></div>
            </section>
        </section>
        <a name='seccion4'></a>
        <section id='seccion4' class='panels'>
            <section id="extra-year-data">
                <header class="headerSection">
                    <h2 class="text-center">Explor&aacute; los top 10</h2>
                </header>
                <!-- <div id="female-year-chart" class="chart year-chart"></div>
      <div id="male-year-chart" class="chart year-chart"></div> -->
            </section>
        </section>

        <div id="scripties">
            <!--[if lt IE 9]><script language="javascript" type="text/javascript" src="excanvas.js"></script><![endif]-->
            <script src="<%= javascript_path('jquery.min.js') %>"></script>
            <script src="<%= javascript_path('bootstrap.min.js') %>"></script>
            <script src="<%= javascript_path('jquery.jqplot.min.js') %>"></script>
            <script src="<%= javascript_path('jqplot-plugins/jqplot.highlighter.min.js') %>"></script>
            <script src="<%= javascript_path('jqplot-plugins/jqplot.cursor.min.js') %>"></script>
            <script src="<%= javascript_path('jqplot-plugins/jqplot.donutRenderer.min.js') %>"></script>
            <script src="<%= javascript_path('data_processor.js') %>"></script>
            <script src="<%= javascript_path('webapp.js') %>"></script>
            <script type="text/javascript" language="JavaScript1.3" src="http://b.scorecardresearch.com/c2/16973189/ct.js"></script>
        </div>
    </body>
</html>
